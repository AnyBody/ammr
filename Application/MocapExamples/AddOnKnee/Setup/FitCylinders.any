#define AddSurface(name, filename, rgb) AnyDrawSurf name = {FileName=filename;ScaleXYZ={1,1,1};RGB=rgb;};
#define AddPointCloud(name, filename) AnyFileVar f_##name = filename; AnyInt npts_##name = STL_Size(f_##name, 0)[0];AnyInt ind##name = iarr(0,1,npts_##name -1); AnyFloat pts_##name = STL_Vertices(f_##name,ind##name,0);
Main = {
  
  AnyFixedRefFrame fr = {

    AnyDrawRefFrame draw={ScaleXYZ={0.5,0.5,0}*0.3;};
    AnyFloat Grey = {1,1,1}*0.45;
    
    AddSurface(femur, "femur.stl", .Grey)
    femur.Opacity=0.2;
    
    AnyDrawPointCloud Femur_PC = 
    {
      //Visible = On;
      //Opacity = 1.0;
      //Pickable = On;
      //PickableZOrdering = 0;
      //RGB = {0.65, 0.65, 0.65};
      //ScaleXYZ = {1.0, 1.0, 1.0};
      //Transparency = 1.0;
      //Face = 2.0;
      /*TextFont = 
      {
      RGB = {0.0, 0.0, 0.0};
      FontName = "Times New Roman";
      Height = 50;
      Width = 50;
      Bold = Off;
      Italic = Off;
      BillBoardView = On;
      ModelSized = On;
      ModelScaleHeight = 1.0;
      ModelScaleWidth = 1.0;
      };*/
      Points = ;
      //PointNames = ;
      /*PointStyle = 
      {
      Visible = On;
      Style = PointStyleSphere;
      Size = 0.01;
      SkipPoints = 0;
      };*/
      //Points3D = Off;
      //ShowNames = On;
      //AnyStyleDrawMaterial &<Insert name0> = <Insert object reference (or full object definition)>; You can make any number of these objects!
    };
    
    
    AnyFloat Green = {0,1,0};
    AnyFloat Red   = {1,0,0};
    AnyFloat Blue  = {0,0,1};
//-------------------------------------------------------------------------------------------------------------------------    
//FIX ME: Ideally  we want to be able to select corresponding nodes from Pointcloud and define these surfaces rather than adding STLs  
//-------------------------------------------------------------------------------------------------------------------------    
    AddSurface( R_Medial_TF , "R_Medial_TF.stl" , .Red)
    AddSurface( R_Lateral_TF , "R_Lateral_TF.stl" , .Red)	
//    AddSurface(R_Lateral_PF_EFC , "R_Lateral_PF_EFC.stl", .Green)
//    AddSurface(R_Lateral_PF_FFC , "R_Lateral_PF_FFC.stl", .Red)
    AddSurface(R_Lateral_TF_EFC , "R_Lateral_TF_EFC.stl", .Blue)
    AddSurface(R_Lateral_TF_FFC , "R_Lateral_TF_FFC.stl", .Green)
//    AddSurface( R_Medial_PF_EFC , "R_Medial_PF_EFC.stl" , .Red)
//    AddSurface( R_Medial_PF_FFC , "R_Medial_PF_FFC.stl" , .Blue)
    AddSurface( R_Medial_TF_EFC , "R_Medial_TF_EFC.stl" , .Blue)
    AddSurface( R_Medial_TF_FFC , "R_Medial_TF_FFC.stl" , .Green)

    
//    AnyRefNode R_Lateral_PF_EFC_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={1,1,1}*0;};
//      AnySurfCylinderFit fitcyl = {
//        AddPointCloud(R_Lateral_PF_EFC , "R_Lateral_PF_EFC.stl")
//        Points = pts_R_Lateral_PF_EFC;
//        #include "cylsettings.any"
//      };
//    };
//
//    AnyRefNode R_Lateral_PF_FFC_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={1,1,1}*0;};
//      AnySurfCylinderFit fitcyl = {
//        AddPointCloud(R_Lateral_PF_FFC , "R_Lateral_PF_FFC.stl")
//        Points = pts_R_Lateral_PF_FFC;
//        #include "cylsettings.any"
//      };
//    };
    

    AnyRefNode R_Medial_TF_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={1,0,0};};
      AnySurfCylinderFit fitcyl = {
        AddPointCloud(R_Medial_TF , "R_Medial_TF.stl")
        Points = pts_R_Medial_TF;
        #include "cylsettings.any"
      };
    };
    
        AnyRefNode R_Lateral_TF_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={1,0,0};};
      AnySurfCylinderFit fitcyl = {
        AddPointCloud(R_Lateral_TF , "R_Lateral_TF.stl")
        Points = pts_R_Lateral_TF;
        #include "cylsettings.any"
      };
    };

    AnyRefNode R_Lateral_TF_FFC_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={0,1,0};};
      AnySurfCylinderFit fitcyl = {
        AddPointCloud(R_Lateral_TF_FFC , "R_Lateral_TF_FFC.stl")
        Points = pts_R_Lateral_TF_FFC;
        #include "cylsettings.any"
      };
    };
    
    AnyRefNode R_Lateral_TF_EFC_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={0,0,1};};
      AnySurfCylinderFit fitcyl = {
        AddPointCloud(R_Lateral_TF_EFC , "R_Lateral_TF_EFC.stl")
        Points = pts_R_Lateral_TF_EFC;
        #include "cylsettings.any"
      };
    };    
    
    
    
//    AnyRefNode R_Medial_PF_EFC_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={1,1,1}*0;};
//      AnySurfCylinderFit fitcyl = {
//        AddPointCloud(R_Medial_PF_EFC , "R_Medial_PF_EFC.stl")
//        Points = pts_R_Medial_PF_EFC;
//        #include "cylsettings.any"
//      };
//    };
//
//    AnyRefNode R_Medial_PF_FFC_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={1,1,1}*0;};
//      AnySurfCylinderFit fitcyl = {
//        AddPointCloud(R_Medial_PF_FFC , "R_Medial_PF_FFC.stl")
//        Points = pts_R_Medial_PF_FFC;
//        #include "cylsettings.any"
//      };
//    };
//    

    AnyRefNode R_Medial_TF_FFC_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={0,1,0};};
      AnySurfCylinderFit fitcyl = {
        AddPointCloud(R_Medial_TF_FFC , "R_Medial_TF_FFC.stl")
        Points = pts_R_Medial_TF_FFC;
        #include "cylsettings.any"
      };
    };
    
    AnyRefNode R_Medial_TF_EFC_node  = {sRel = fitcyl.sRel;ARel = fitcyl.ARel;AnyDrawNode n={ScaleXYZ={1,1,1}*0.001;RGB={0,0,1};};
      AnySurfCylinderFit fitcyl = {
        AddPointCloud(R_Medial_TF_EFC , "R_Medial_TF_EFC.stl")
        Points = pts_R_Medial_TF_EFC;
        #include "cylsettings.any"
      };
    };      
  };
};