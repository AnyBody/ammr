#include "../libdef.any"


#define BalanceOnOff 0


#include "<ANYBODY_PATH_BODY>/ToolBox/Widgets/TripodOnPlane.any"
#include "<ANYBODY_PATH_BODY>/ToolBox/Widgets/3DForce.any"
#include "<ANYBODY_PATH_BODY>/ToolBox/Widgets/WidgetMarkerDriver.any"
#include "jointlimit/JointsLimits_template.any"

Main = {
  
  
  // ----------------------------------------------------------
  // Model configuration:
  // For more info on body model configuration options please load the model and double click on: 
  // #include "<ANYBODY_PATH_BODY>\Documentation\BodyModel.parameters.any"
  // ----------------------------------------------------------
#define BM_MANNEQUIN_DRIVER_DEFAULT OFF
#define SelectedDriverOnOff ON
//
//



  // ----------------------------------------------------------
  // Path to draw settings
  // ----------------------------------------------------------
  #path BM_DRAWSETTINGS_FILE "Model/DrawSettings.any"

// ----------------------------------------------------------
  // ----------------------------------------------------------

  // The model is without muscles

//  #define BM_ARM_MUSCLES_BOTH OFF
 #define BM_ARM_LEFT OFF 
  #define BM_ARM_RIGHT OFF 

  #define BM_LEG_MUSCLES_BOTH OFF
  #define BM_ARM_MUSCLES_BOTH OFF
  #define BM_TRUNK_MUSCLES OFF
  
//// Switch for the mannequin driver being active or not
//#define BM_MANNEQUIN_DRIVER_PELVIS_POS_X SelectedDriverOnOff
//#define BM_MANNEQUIN_DRIVER_PELVIS_POS_Y SelectedDriverOnOff
//#define BM_MANNEQUIN_DRIVER_PELVIS_POS_Z SelectedDriverOnOff
//#define BM_MANNEQUIN_DRIVER_PELVIS_ROT_Z SelectedDriverOnOff
//#define BM_MANNEQUIN_DRIVER_PELVIS_ROT_Y SelectedDriverOnOff
//#define BM_MANNEQUIN_DRIVER_PELVIS_ROT_X SelectedDriverOnOff

#define BM_MANNEQUIN_DRIVER_PELVIS_THORAX_LATERAL_BENDING SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_PELVIS_THORAX_ROTATION SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_PELVIS_THORAX_EXTENSION SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_NECK SelectedDriverOnOff

#if BM_ARM_RIGHT
#define BM_MANNEQUIN_DRIVER_STERNO_CLAVICULAR_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_GLENOHUMERAL_ABDUCTION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_GLENOHUMERAL_FLEXION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_GLENOHUMERAL_EXTERNAL_ROTATION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ELBOW_FLEXION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ELBOW_PRONATION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_WRIST_FLEXION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_WRIST_ABDUCTION_RIGHT SelectedDriverOnOff
#endif

#if BM_ARM_LEFT
#define BM_MANNEQUIN_DRIVER_STERNO_CLAVICULAR_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_GLENOHUMERAL_ABDUCTION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_GLENOHUMERAL_FLEXION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_GLENOHUMERAL_EXTERNAL_ROTATION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ELBOW_FLEXION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ELBOW_PRONATION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_WRIST_FLEXION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_WRIST_ABDUCTION_LEFT SelectedDriverOnOff
#endif

#define BM_MANNEQUIN_DRIVER_HIP_FLEXION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_HIP_EXTERNAL_ROTATION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_HIP_ABDUCTION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_KNEE_FLEXION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ANKLE_FLEXION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ANKLE_EVERSION_RIGHT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ANKLE_SUBTALAR_EVERSION_RIGHT SelectedDriverOnOff

#define BM_MANNEQUIN_DRIVER_HIP_FLEXION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_HIP_EXTERNAL_ROTATION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_HIP_ABDUCTION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_KNEE_FLEXION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ANKLE_FLEXION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ANKLE_EVERSION_LEFT SelectedDriverOnOff
#define BM_MANNEQUIN_DRIVER_ANKLE_SUBTALAR_EVERSION_LEFT SelectedDriverOnOff

  
  // The Mannequin file specifies load-time positions for all the segments
  // in the HumanModel. This is important for the model's ablity to resolve
  // all the kinematic constraints when the model is analyzed.
  // The mannequin file also drives those degrees of freedom of the human 
  // model that are not governed by problem-specific drivers at run time.    
  #path BM_MANNEQUIN_FILE "Model/Mannequin.any" 

  // Model of the human body to be used for the analysis  
  #include "<ANYBODY_PATH_BODY>/HumanModel.any"

  
  
  
  
  /// The actual model where all components are assembled  
  AnyFolder Model ={
    /// Body model without default drivers
    AnyFolder &HumanModel=.HumanModel.BodyModelWithDefaultDrivers;
    /// Reference to the mannequin folder (used by drivers)
    AnyFolder &Mannequin =.HumanModel.Mannequin;    

    #include "Model/Environment.any"   
    
    AnyFolder ModelEnvironmentConnection = {
     #include "Model/JointsAndDrivers.any"
   //  #include "Model/BalanceModel.any"
 //  CreateJointLimitDrivers DriversLim(ENABLE_ALL_JOINT_LIMITS = "On")={};
            
     
    };
    
     AnyFolder KinematicWidgets={
      
    };
    
    AnyFolder KineticWidgets={
     
    };

  };

  AnyBodyStudy Study = {
    AnyFolder &Model = .Model;
//        CreateJointLimitDrivers JointLimits( 
//        PELVIS_THORAX_EXTENSION = "On",
//      PELVIS_THORAX_LATERAL_BENDING = "On",
//      PELVIS_THORAX_ROTATION = "On",
//      SKULL_THORAX_FLEXION = "On",
//      SKULL_THORAX_LATERALBENDING = "On",
//      SKULL_THORAX_ROTATION = "On",
//      STERNO_CLAVICULAR_PROTRACTION = "Off",
//      STERNO_CLAVICULAR_ELEVATION = "Off",
//      STERNO_CLAVICULAR_AXIALROTATION = "Off",
//      GLENOHUMERAL_FLEXION = "Off",
//      GLENOHUMERAL_EXTERNAL_ROTATION = "Off",
//      GLENOHUMERAL_ABDUCTION = "Off",
//      ELBOW_FLEXION = "Off",
//      ELBOW_PRONATION = "Off",
//      WRIST_FLEXION = "Off",
//      WRIST_ABDUCTION = "Off",
//      HIP_ABDUCTION = "On",
//      HIP_FLEXION = "On",
//      HIP_EXTERNAL_ROTATION = "On",
//      KNEE_FLEXION = "On",
//      ANKLE_PLANTAR_FLEXION = "On",
//      SUBTALAR_EVERSION = "On",
//       NECK_3DOF = "On")={};


 CreateJointLimitDrivers JointLimits( 
        PELVIS_THORAX_EXTENSION = "Off",
      PELVIS_THORAX_LATERAL_BENDING = "Off",
      PELVIS_THORAX_ROTATION = "Off",
      SKULL_THORAX_FLEXION = "Off",
      SKULL_THORAX_LATERALBENDING = "Off",
      SKULL_THORAX_ROTATION = "Off",
      STERNO_CLAVICULAR_PROTRACTION = "Off",
      STERNO_CLAVICULAR_ELEVATION = "Off",
      STERNO_CLAVICULAR_AXIALROTATION = "Off",
      GLENOHUMERAL_FLEXION = "Off",
      GLENOHUMERAL_EXTERNAL_ROTATION = "Off",
      GLENOHUMERAL_ABDUCTION = "Off",
      ELBOW_FLEXION = "Off",
      ELBOW_PRONATION = "Off",
      WRIST_FLEXION = "Off",
      WRIST_ABDUCTION = "Off",
      HIP_ABDUCTION = "Off",
      HIP_FLEXION = "Off",
      HIP_EXTERNAL_ROTATION = "Off",
      KNEE_FLEXION = "On",
      ANKLE_PLANTAR_FLEXION = "Off",
      SUBTALAR_EVERSION = "Off",
       NECK_3DOF = "Off")={};


    tEnd = 1.0;
    Gravity = {0.0, -9.81, 0.0};
    nStep = 10;
    Kinematics.KinematicTol=3e-4;
    InitialConditions.KinematicTol=3e-4;
    //include the next line to have a camera in the model
    //#include "Model/MovingCamera.any"
    InitialConditions.SolverType = KinSolOverDeterminate;
    InitialConditions.PosAnalysisOnlyOnOff=On;
    Kinematics.SolverType = KinSolOverDeterminate;
    InitialConditions.SmallStepAssumptionOnOff=Off;
    Kinematics.UseStartGuessOnOff=Off;
    InitialConditions.UseStartGuessOnOff=Off;
    Kinematics.PosAnalysisOnlyOnOff=On;
//    AnyMechOprKinAnl PositionAnalysisForWidget = {
//      SolverType = KinSolOverDeterminate;
//      UseStartGuessOnOff = Off;
//      KinematicTol=3e-4;
//      PosAnalysisOnlyOnOff=On;
//    //  SingleStepOnOff=On;
//      SmallStepAssumptionOnOff=Off;
//    };
    
    
  }; // End of study

  
AnyOperation &OnMouseReleaseOperations =Study.Kinematics ;

  
  // Include an operation sequence to run all required steps of your application (see Operations tab)
    #include "<ANYBODY_PATH_TOOLBOX>\Operations\RunAppSequence.any"  
  
}; //Main


