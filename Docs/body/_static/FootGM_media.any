#path ANYBODY_PATH_OUTPUT "."
#include "../../../libdef.any"

#define BM_ARM_LEFT OFF
#define BM_ARM_RIGHT OFF
#define BM_TRUNK_MUSCLES OFF
#define BM_LEG_LEFT OFF
#define BM_LEG_MODEL _LEG_MODEL_TLEM2_
#define BM_LEG_MUSCLES_RIGHT OFF

//#define BM_FOOT_MODEL _FOOT_MODEL_RIGID_GM_
//#define BM_FOOT_MODEL _FOOT_MODEL_TOE_FLEX_GM_
#define BM_FOOT_MODEL _FOOT_MODEL_DETAILED_GM_


#include "<ANYBODY_PATH_MODELUTILS>/Video/VideoLookAtCamera.any"




Main = {
  Main.DrawSettings.Ligament.Opacity = 0.0;
  Main.HumanModel.BodyModel.Right.Leg.Seg.Foot = {
    AnyFloat RGBColorMap = repmat(4,{
      {228,2,3}/255,     // Red
      {253,140,0}/255,   // Orange
      {254,236,2}/255,   // Yellow
      {0,128,41}/255,    // Dark Green
      {0,77,253}/255,    // Blue
      {118,7,137}/255,   // Dark Purple
      {255,175,200}/255, // Rose
      {116,215,238}/255, // LightTurquoise
    });

    #if BM_FOOT_MODEL == _FOOT_MODEL_RIGID_GM_
    #define VIDEO_NAME "FootRigidGM"
    Calcaneus.DrwSurf             = {RGB = ..RGBColorMap[3];};
    Cuboid.DrwSurf                = {RGB = ..RGBColorMap[3];};
    DistalPhalange1.DrwSurf       = {RGB = ..RGBColorMap[3];};
    DistalPhalange2.DrwSurf       = {RGB = ..RGBColorMap[3];};
    DistalPhalange3.DrwSurf       = {RGB = ..RGBColorMap[3];};
    DistalPhalange4.DrwSurf       = {RGB = ..RGBColorMap[3];};
    DistalPhalange5.DrwSurf       = {RGB = ..RGBColorMap[3];};
    IntermediateCuneiform.DrwSurf = {RGB = ..RGBColorMap[3];};
    LateralCuneiform.DrwSurf      = {RGB = ..RGBColorMap[3];};
    MedialCuneiform.DrwSurf       = {RGB = ..RGBColorMap[3];};
    Metatarsal1.DrwSurf           = {RGB = ..RGBColorMap[3];};
    Metatarsal2.DrwSurf           = {RGB = ..RGBColorMap[3];};
    Metatarsal3.DrwSurf           = {RGB = ..RGBColorMap[3];};
    Metatarsal4.DrwSurf           = {RGB = ..RGBColorMap[3];};
    Metatarsal5.DrwSurf           = {RGB = ..RGBColorMap[3];};
    MiddlePhalange2.DrwSurf       = {RGB = ..RGBColorMap[3];};
    MiddlePhalange3.DrwSurf       = {RGB = ..RGBColorMap[3];};
    MiddlePhalange4.DrwSurf       = {RGB = ..RGBColorMap[3];};
    MiddlePhalange5.DrwSurf       = {RGB = ..RGBColorMap[3];};
    Navicular.DrwSurf             = {RGB = ..RGBColorMap[3];};
    ProximalPhalange1.DrwSurf     = {RGB = ..RGBColorMap[3];};
    ProximalPhalange2.DrwSurf     = {RGB = ..RGBColorMap[3];};
    ProximalPhalange3.DrwSurf     = {RGB = ..RGBColorMap[3];};
    ProximalPhalange4.DrwSurf     = {RGB = ..RGBColorMap[3];};
    ProximalPhalange5.DrwSurf     = {RGB = ..RGBColorMap[3];};
    Talus.DrwSurf                 = {RGB = ..RGBColorMap[1];};
    #endif
    #if BM_FOOT_MODEL == _FOOT_MODEL_TOE_FLEX_GM_
    #define VIDEO_NAME "FootToeFlexGM"
    Calcaneus.DrwSurf             = {RGB = ..RGBColorMap[3];};
    Cuboid.DrwSurf                = {RGB = ..RGBColorMap[3];};
    DistalPhalange1.DrwSurf       = {RGB = ..RGBColorMap[2];};
    DistalPhalange2.DrwSurf       = {RGB = ..RGBColorMap[2];};
    DistalPhalange3.DrwSurf       = {RGB = ..RGBColorMap[2];};
    DistalPhalange4.DrwSurf       = {RGB = ..RGBColorMap[2];};
    DistalPhalange5.DrwSurf       = {RGB = ..RGBColorMap[2];};
    IntermediateCuneiform.DrwSurf = {RGB = ..RGBColorMap[3];};
    LateralCuneiform.DrwSurf      = {RGB = ..RGBColorMap[3];};
    MedialCuneiform.DrwSurf       = {RGB = ..RGBColorMap[3];};
    Metatarsal1.DrwSurf           = {RGB = ..RGBColorMap[3];};
    Metatarsal2.DrwSurf           = {RGB = ..RGBColorMap[3];};
    Metatarsal3.DrwSurf           = {RGB = ..RGBColorMap[3];};
    Metatarsal4.DrwSurf           = {RGB = ..RGBColorMap[3];};
    Metatarsal5.DrwSurf           = {RGB = ..RGBColorMap[3];};
    MiddlePhalange2.DrwSurf       = {RGB = ..RGBColorMap[2];};
    MiddlePhalange3.DrwSurf       = {RGB = ..RGBColorMap[2];};
    MiddlePhalange4.DrwSurf       = {RGB = ..RGBColorMap[2];};
    MiddlePhalange5.DrwSurf       = {RGB = ..RGBColorMap[2];};
    Navicular.DrwSurf             = {RGB = ..RGBColorMap[3];};
    ProximalPhalange1.DrwSurf     = {RGB = ..RGBColorMap[2];};
    ProximalPhalange2.DrwSurf     = {RGB = ..RGBColorMap[2];};
    ProximalPhalange3.DrwSurf     = {RGB = ..RGBColorMap[2];};
    ProximalPhalange4.DrwSurf     = {RGB = ..RGBColorMap[2];};
    ProximalPhalange5.DrwSurf     = {RGB = ..RGBColorMap[2];};
    Talus.DrwSurf                 = {RGB = ..RGBColorMap[1];};
    #endif
    #if BM_FOOT_MODEL == _FOOT_MODEL_DETAILED_GM_
    #define VIDEO_NAME "FootDetailedGM"
    Calcaneus.DrwSurf             = {RGB = ..RGBColorMap[0];};
    Cuboid.DrwSurf                = {RGB = ..RGBColorMap[1];};
    DistalPhalange1.DrwSurf       = {RGB = ..RGBColorMap[2];};
    DistalPhalange2.DrwSurf       = {RGB = ..RGBColorMap[3];};
    DistalPhalange3.DrwSurf       = {RGB = ..RGBColorMap[4];};
    DistalPhalange4.DrwSurf       = {RGB = ..RGBColorMap[5];};
    DistalPhalange5.DrwSurf       = {RGB = ..RGBColorMap[6];};
    IntermediateCuneiform.DrwSurf = {RGB = ..RGBColorMap[7];};
    LateralCuneiform.DrwSurf      = {RGB = ..RGBColorMap[8];};
    MedialCuneiform.DrwSurf       = {RGB = ..RGBColorMap[9];};
    Metatarsal1.DrwSurf           = {RGB = ..RGBColorMap[10];};
    Metatarsal2.DrwSurf           = {RGB = ..RGBColorMap[11];};
    Metatarsal3.DrwSurf           = {RGB = ..RGBColorMap[12];};
    Metatarsal4.DrwSurf           = {RGB = ..RGBColorMap[13];};
    Metatarsal5.DrwSurf           = {RGB = ..RGBColorMap[14];};
    MiddlePhalange2.DrwSurf       = {RGB = ..RGBColorMap[15];};
    MiddlePhalange3.DrwSurf       = {RGB = ..RGBColorMap[16];};
    MiddlePhalange4.DrwSurf       = {RGB = ..RGBColorMap[17];};
    MiddlePhalange5.DrwSurf       = {RGB = ..RGBColorMap[18];};
    Navicular.DrwSurf             = {RGB = ..RGBColorMap[19];};
    ProximalPhalange1.DrwSurf     = {RGB = ..RGBColorMap[20];};
    ProximalPhalange2.DrwSurf     = {RGB = ..RGBColorMap[21];};
    ProximalPhalange3.DrwSurf     = {RGB = ..RGBColorMap[22];};
    ProximalPhalange4.DrwSurf     = {RGB = ..RGBColorMap[23];};
    ProximalPhalange5.DrwSurf     = {RGB = ..RGBColorMap[24];};
    Talus.DrwSurf                 = {RGB = ..RGBColorMap[25];};
    #endif
  };
  
  #ifndef VIDEO_NAME
  #define VIDEO_NAME "Foot"
  #endif
  
  
  VideoLookAtCamera SnapShot1(UP_DIRECTION=y, _AUTO_OPEN_PREVIEW_=0, TRANSPARENT_BACKGROUND=1) =
  {
    VideoName = VIDEO_NAME + "_closeup";
    Analysis = {
      AnyOperation &ref = Main.study.InitialConditions;
    };
    Camera.Perspective = On;
    CameraDistance = 1.04;
    VideoInputScale = 5;
    VideoResolution = {600,600};
    CameraLookAtPoint = Main.HumanModel.BodyModel.Right.Leg.Seg.Talus.r+{0.1,0,0};
    CameraFieldOfView = DesignVar(0.2);
    CameraDirection  = {1,0.3,0.8};
    BackgroundColor = DesignVar({1,1,1});
    Preview.FileName = VideoName + ".png";
  };   
  
  HumanModel.Mannequin.Posture.Right = {
    ElbowPronation = -70;
    WristAbduction = 15;
  };


//  VideoLookAtCamera RotatingVideo(UP_DIRECTION=y , _AUTO_PLAY_VIDEOS=OFF) =
//  {
//    VideoName = VIDEO_NAME + "_rotating_model";
//    
//    Analysis = {
//      AnyOperation &ref = Main.study.Kinematics;
//    };
//    VideoInputScale = 5;
//    VideoResolution = {350,350};
//    VideoInputFrameRate = 30; 
//    VideoOutputFrameRate = 30;
//    CameraLookAtPoint = Main.HumanModel.BodyModel.Right.Leg.Seg.Talus.r+{0.1,0,0};
//    CameraFieldOfView = DesignVar(1.15);
//    CameraDirection  = {cos(2*pi*Main.study.t),0,sin(2*pi*Main.study.t) };
//    BackgroundColor = DesignVar({1,1,1});
//    Counter = Main.study.iStep;
//  }; 
   
  
  #include "<ANYBODY_PATH_BODY>\HumanModel.any"

   
  AnyBodyStudy study = 
  {
//    AnyFolder& CameraRef1 = Main.RotatingVideo;
    AnyFolder& Model = Main.HumanModel.BodyModelWithDefaultDrivers;
    Gravity = {0, -9.81, 0};
    nStep = 1;
 };
  
  
  AnyOperationSequence RunApplication = 
  {
//     AnyOperation& initpos = Main.study.InitialConditions;
     AnyOperation& SnapShot1 = Main.SnapShot1.Preview;
//     AnyOperation& RotatingVideo = Main.RotatingVideo.Create_Video;
  };
  
};