#class_template JointAngleOuputFile(__CLASS__ = AnyOutputFile){
  #var FileName;
  SepSign = ",";
  Header = {
    TitleSectionOnOff = Off;
    ConstSectionOnOff = Off;
    ConstSectionSaveOptionsOnOff = Off;
    VarSectionOnOff = Off;
    ShortenNamesOnOff = Off;
  };
};

AnyFolder JointAngleOutputs = {

  AnyString BaseName = TEMP_PATH+"/"+ MOCAP_TEST_FILENAME_PREFIX + MOCAP_OUTPUT_FILENAME_PREFIX + Main.ModelSetup.TrialSpecificData.TrialFileName;
  AnyVec3 ZeroVar = {0,0,0};

  JointAngleOuputFile OutputFile_TrunkFull =
  {
    FileName = .BaseName + "-rotvec-trunk-full.txt";

    Values = {
      &..BodyModel.Interface.Trunk.PelvisPosX.Pos,
      &..BodyModel.Interface.Trunk.PelvisPosY.Pos,
      &..BodyModel.Interface.Trunk.PelvisPosZ.Pos,
      & ..BodyModel.Interface.Trunk.PelvisRotVec.Pos,
      & ..BodyModel.Interface.Trunk.IntervertebralAngles.SacrumPelvis.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.L5Sacrum.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.L4L5.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.L3L4.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.L2L3.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.L1L2.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T12L1.Jnt.Pos,
#if BM_TRUNK_THORACIC_MODEL != _THORACIC_MODEL_RIGID_
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T11T12.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T10T11.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T9T10.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T8T9.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T7T8.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T6T7.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T5T6.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T4T5.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T3T4.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T2T3.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T1T2.Jnt.Pos,
#endif
      &..BodyModel.Interface.Trunk.IntervertebralAngles.T1C7.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.C7C6.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.C6C5.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.C5C4.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.C4C3.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.C3C2.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.C2C1.Jnt.Pos,
      &..BodyModel.Interface.Trunk.IntervertebralAngles.C1C0.Jnt.Pos,
    };
  };


#if BM_LEG_LEFT
  JointAngleOuputFile OutputFile_LeftLeg =
  {
    #if BM_LEG_MODEL_IS_TLEM
    FileName = .BaseName + "-euler-left_leg_tlem.txt";
    Values = {
      &..BodyModel.Interface.Left.HipFlexion.Pos,
      &..BodyModel.Interface.Left.HipAbduction.Pos,
      &..BodyModel.Interface.Left.HipExternalRotation.Pos,
      &..BodyModel.Interface.Left.KneeFlexion.Pos,
      &..BodyModel.Interface.Left.AnklePlantarFlexion.Pos,
      &..BodyModel.Interface.Left.SubTalarEversion.Pos
    };
    #else
    FileName = .BaseName + "-euler-left_leg.txt";
    Values = {
      &..BodyModel.Interface.Left.HipFlexion.Pos,
      &..BodyModel.Interface.Left.HipAbduction.Pos,
      &..BodyModel.Interface.Left.HipExternalRotation.Pos,
      &..BodyModel.Interface.Left.KneeFlexion.Pos,
      &..BodyModel.Interface.Left.AnklePlantarFlexion.Pos,
      &..BodyModel.Interface.Left.AnkleEversion.Pos
    };
    #endif
  };
  #if BM_FOOT_MODEL == _FOOT_MODEL_TOE_FLEX_GM_
  AnyOutputFile OutputFile_LeftFoot_ToeFlex = {
    FileName = .BaseName + "-euler-left_foot_toeflex.txt";
    SepSign = ",";
    SepSpaceAutoOnOff = Off;
    Header.TitleSectionOnOff = Off;
    Header.ConstSectionOnOff = Off;
    Header.ConstSectionSaveOptionsOnOff = Off;
    Header.VarSectionOnOff = Off;

    AnyVector JntMtPhal1 = ..BodyModel.Interface.Left.MetatarsoPhalangeal1DorsiFlexion.Pos;
  };
  #endif
#endif


#if BM_LEG_RIGHT
  JointAngleOuputFile OutputFile_RightLeg =
  {
    #if BM_LEG_MODEL_IS_TLEM
    FileName = .BaseName + "-euler-right_leg_tlem.txt";
    Values = {
      &..BodyModel.Interface.Right.HipFlexion.Pos,
      &..BodyModel.Interface.Right.HipAbduction.Pos,
      &..BodyModel.Interface.Right.HipExternalRotation.Pos,
      &..BodyModel.Interface.Right.KneeFlexion.Pos,
      &..BodyModel.Interface.Right.AnklePlantarFlexion.Pos,
      &..BodyModel.Interface.Right.SubTalarEversion.Pos
    };
    #else
    FileName = TEMP_PATH+"/"+ BaseName + "-euler-right_leg.txt";
    Values = {
      &..BodyModel.Interface.Right.HipFlexion.Pos,
      &..BodyModel.Interface.Right.HipAbduction.Pos,
      &..BodyModel.Interface.Right.HipExternalRotation.Pos,
      &..BodyModel.Interface.Right.KneeFlexion.Pos,
      &..BodyModel.Interface.Right.AnklePlantarFlexion.Pos,
      &..BodyModel.Interface.Right.AnkleEversion.Pos
    };
    #endif
  };
  #if BM_FOOT_MODEL == _FOOT_MODEL_TOE_FLEX_GM_
  AnyOutputFile OutputFile_RightFoot_ToeFlex = {
    FileName = .BaseName + "-euler-right_foot_toeflex.txt";
    SepSign = ",";
    SepSpaceAutoOnOff = Off;
    Header.TitleSectionOnOff = Off;
    Header.ConstSectionOnOff = Off;
    Header.ConstSectionSaveOptionsOnOff = Off;
    Header.VarSectionOnOff = Off;

    AnyVector JntMtPhal1 = ..BodyModel.Interface.Right.MetatarsoPhalangeal1DorsiFlexion.Pos;
  };
  #endif
#endif



#if BM_ARM_LEFT == ON

  JointAngleOuputFile OutputFile_LeftArm =
  {
    FileName = .BaseName + "-rotvec-left_arm_shoulder.txt";
    Values = {
      &..BodyModel.Interface.Left.RotVectorMeasures.ThoraxClavicula.Pos,
      &..BodyModel.Interface.Left.RotVectorMeasures.ClaviculaScapula.Pos,
      &..BodyModel.Interface.Left.RotVectorMeasures.ScapulaHumerus.Pos,
      &..BodyModel.Interface.Left.ElbowFlexion.Pos,
      &..BodyModel.Interface.Left.ElbowPronation.Pos,
      &..BodyModel.Interface.Left.WristFlexion.Pos,
      &..BodyModel.Interface.Left.WristAbduction.Pos,
    };
  };

  #if BM_ARM_DETAILED_HAND
  JointAngleOuputFile OutputFile_LeftDetailedHand = {
    FileName = .BaseName + "-euler-left_detailed_hand.txt";
    Values = {
      &..BodyModel.Interface.Left.CMCFlexion.Pos,
      &..BodyModel.Interface.Left.CMCAbduction.Pos,
      &..BodyModel.Interface.Left.MCPFlexion.Pos,
      &..BodyModel.Interface.Left.MCPAbduction.Pos,
      &..BodyModel.Interface.Left.DIP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger2.Jnt.MCP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger2.Jnt.PIP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger2.Jnt.DIP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger3.Jnt.MCP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger3.Jnt.PIP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger3.Jnt.DIP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger4.Jnt.MCP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger4.Jnt.PIP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger4.Jnt.DIP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger5.Jnt.MCP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger5.Jnt.PIP.Pos,
      &..BodyModel.Left.ShoulderArm.Segments.Hand.Finger5.Jnt.DIP.Pos
    };
  };
  #endif

#endif


#if BM_ARM_RIGHT == ON

  JointAngleOuputFile OutputFile_RightArm = {
    FileName = .BaseName + "-rotvec-right_arm_shoulder.txt";
    Values = {
      &..BodyModel.Interface.Right.RotVectorMeasures.ThoraxClavicula.Pos,
      &..BodyModel.Interface.Right.RotVectorMeasures.ClaviculaScapula.Pos,
      &..BodyModel.Interface.Right.RotVectorMeasures.ScapulaHumerus.Pos,
      &..BodyModel.Interface.Right.ElbowFlexion.Pos,
      &..BodyModel.Interface.Right.ElbowPronation.Pos,
      &..BodyModel.Interface.Right.WristFlexion.Pos,
      &..BodyModel.Interface.Right.WristAbduction.Pos,

    };
  };

  #if BM_ARM_DETAILED_HAND

  JointAngleOuputFile OutputFile_RightDetailedHand = {
    FileName = .BaseName + "-euler-right_detailed_hand.txt";
    Values = {
      &..BodyModel.Interface.Right.CMCFlexion.Pos,
      &..BodyModel.Interface.Right.CMCAbduction.Pos,
      &..BodyModel.Interface.Right.MCPFlexion.Pos,
      &..BodyModel.Interface.Right.MCPAbduction.Pos,
      &..BodyModel.Interface.Right.DIP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger2.Jnt.MCP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger2.Jnt.PIP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger2.Jnt.DIP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger3.Jnt.MCP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger3.Jnt.PIP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger3.Jnt.DIP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger4.Jnt.MCP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger4.Jnt.PIP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger4.Jnt.DIP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger5.Jnt.MCP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger5.Jnt.PIP.Pos,
      &..BodyModel.Right.ShoulderArm.Segments.Hand.Finger5.Jnt.DIP.Pos
    };
  };

  #endif

#endif

#if (ANYBODY_V1 > 8) | (ANYBODY_V1 == 8 & ANYBODY_V2 > 1) | (ANYBODY_V1 == 8 & ANYBODY_V2 == 1 & ANYBODY_V3 > 2 )
AnyFolder   AllDoFs = {
  AnyStringVar HeaderPrefix ??= "DOF:";
  AnyFloat Values = Obj2NumFlatten(flattenptr(ObjSearch(ObjGetParent(), "OutputFile*.Values")));
  AnyStringArray HeaderNames = take(
       arrcat(
          repmat(NumElemOf(Obj2StrFlatten(flattenptr(ObjSearch(ObjGetParent(),"OutputFile*.ColumnNames")))), HeaderPrefix) +
          Obj2StrFlatten(flattenptr(ObjSearch(ObjGetParent(),"OutputFile*.ColumnNames"))),
          repmat(NumElemOf(Values),"")
       ),
       iarr(0, NumElemOf(Values)-1)
    );
};
#endif

}; //JointAngleOutputs



