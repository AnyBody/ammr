//# Defintions for the python test framwork 
//ignore_errors = ["'Set Value' operation on"]
//fatal_warnings = True
//pytest_markers=["slow"]
//save_study=[
//  "Main.Studies.ParameterIdentification",
//]


#include "../libdef.any"

#path MOCAP_PATH_MAINFILEDIR "../../Application/Beta/Plug-in-gait_Simple_DetailedFoot_GM"
#path MOCAP_PATH_MAINFILE "<MOCAP_PATH_MAINFILEDIR>/LowerExtremity.main.any"
#define MOCAP_NAME_MAINFILEDIR "Plug-in-gait_Simple_DetailedFoot_GM"

//// Run Analysis with a reduced number of time steps
//// to make test go faster. 
#define N_STEP_KINEMATICS 20
#define N_STEP 20

#ifdef TEST_NAME
#endif


#ifdef CREATE_IMAGE
#undef MOCAP_TEST_FILENAME_PREFIX
#define MOCAP_TEST_FILENAME_PREFIX "LowerExtremity_"
#path TEMP_PATH "<MOCAP_PATH_MAINFILEDIR>/Output"
#endif


#include "<MOCAP_PATH_MAINFILE>"

Main = 
{  
  
  AnyOperationSequence  TestRunApplication = 
  {
    AnyOperation& loadparam =  Main.RunAnalysis.LoadParameters.Load_parameters_from_anyset;
    AnyOperation& cal =  Main.GMFoot_RunParamOptimization.LigamentCal;
    AnyOperation& paramid = Main.RunParameterIdentification.ParameterIdentification;
    // Tests skips saving the results.
  };

  #ifndef CREATE_IMAGE
    AnyOperation& RunTest = Main.TestRunApplication;
  #else
    #include "../Cameras.any"
    AnyOperationSequence CameraInitPos = 
    {
      AnyOperation& ref1 = Main.GMFoot_RunMarkerTrackingAndInverse.LoadParameters;
      AnyOperation& LigCal = Main.GMFoot_RunMarkerTrackingAndInverse.LigamentCal;
      AnyOperation& InverseDynamics = Main.Studies.InverseDynamicStudy.InitialConditions;
    };
    LoadTimeCam.CameraLookAtPoint = Main.EnvironmentModel.ForcePlates.Plate1.Corners.PlateCenter.sRel - {0,0.15,0};
    LoadTimeCam.CameraFieldOfView = DesignVar(1);
    LoadTimeCam.CameraDirection  = {0.0,0.001,2.3};
    LoadTimeCam.CameraUpDirection  = {0.0,0.0,1.0};
  #endif    
};