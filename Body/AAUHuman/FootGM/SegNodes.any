Shank = {

  AnyRefNode LigTibioTalarPosterior = {
    sRel = .Scale(.Data.LigTibioTalarPosterior);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };
  AnyRefNode LigTibioTalarAnterior = {
    sRel = .Scale(.Data.LigTibioTalarAnterior);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };
  AnyRefNode LigTibioCalcaneal = {
    sRel = .Scale(.Data.LigTibioCalcaneal);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };
  AnyRefNode LigTibioNavicular = {
    sRel = .Scale(.Data.LigTibioNavicular);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };
  AnyRefNode LigTaloFibularPosterior = {
    sRel = .Scale(.Data.LigTaloFibularPosterior);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };
  AnyRefNode LigTaloFibularAnterior = {
    sRel = .Scale(.Data.LigTaloFibularAnterior);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };
  AnyRefNode LigCalcaneoFibular = {
    sRel = .Scale(.Data.LigCalcaneoFibular);
    //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
  };
  AnyRefNode PeroneusTertius1Node = {sRel = .Scale(.Data.PeroneusTertius1Node);};
  AnyRefNode PeroneusTertius2Node = {sRel = .Scale(.Data.PeroneusTertius2Node);};
  AnyRefNode PeroneusTertius3Node = {sRel = .Scale(.Data.PeroneusTertius3Node);};
  AnyRefNode PeroneusTertiusViaNode1 = {sRel = .Scale(.Data.PeroneusTertiusViaNode1);};

}; // end Shank

Foot = {

  //These pointers and values are only used for compatibility with references in the LegTD files using the stiff foot originally.
  //It forwards the references to the coresponding element of the detailed foot.
  AnyRefFrame &AnatomicalFrame = Talus.AnatomicalFrame;
  AnyRefFrame &ScalingNode = Talus.ScalingNode;
  AnyRefFrame &SubTalarJoint = Calcaneus.SubTalarJoint;
  AnyRefFrame &HeelNode = Calcaneus.HeelNode;
//  AnyRefFrame &HeelContactNodeLow = Calcaneus.HeelContactNodeLow;
//  AnyRefFrame &BigToeNode = Toe1.DistalPhalange1.ToeTip;
//  AnyRefFrame &ToeMedialContactNode = ProximalPhalange1.ToeMedialContactNode;
//  AnyRefFrame &ToeLateralContactNode = ProximalPhalange5.ToeLateralContactNode;


  AnyFolder &Data = ..ModelParameters.FootGM;
  AnyVar Sign = ..Sign;
  AnyFloat pUnscaled = {Data.LateralMalleolus, Data.MedialMalleolus, Data.Metatarsal2PlantarNode,Data.HeelPlantarNode, Data.Metatarsal5PlantarNode, Data.Metatarsal1PlantarNode};
  // p={LateralMalleolus, MedialMalleolus, Metatarsal2, Heel, Metatarsal5, Metatarsal1} //bony landmarks to define orgin and long axis of the foot
  // and three coplanar points to define the horizontal plane parallel to the ground. These can be on the bones, skin, shoe, etc. and
  // determine the proximal-distal axis of the foot and ankle plantarflexion zero value


  Talus = {

    AnyVar Sign = .Sign;
    AnyFolder &Data =.Data.Talus;

    AnyFloat pUnscaled = .pUnscaled;
    #define MACRO_CONSTRUCT_ANATOMICAL_FRAME_s(p, SIGN) 0.5*(p[0]+p[1])
    #define MACRO_CONSTRUCT_ANATOMICAL_FRAME_A(p, SIGN) RotMat(0.5*(p[0]+p[1]),0.5*(p[0]+p[1]) + cross(p[4]-p[3],p[5]-p[3])*SIGN, p[2]) * RotMat(-0.5*pi,z) * RotMat(1*pi,y)

    AnyRefNode AnatomicalFrame =
    {
      AnyFloat pScaled = .Scale(.pUnscaled);
      sRel = MACRO_CONSTRUCT_ANATOMICAL_FRAME_s(pScaled, .Sign);
      ARel = MACRO_CONSTRUCT_ANATOMICAL_FRAME_A(pScaled, .Sign);
      AnyVec3 sRelUnscaled = MACRO_CONSTRUCT_ANATOMICAL_FRAME_s(.pUnscaled, .Sign);///< Generic unscaled position of foot ScalingNode
      AnyMat33 ARelUnscaled = MACRO_CONSTRUCT_ANATOMICAL_FRAME_A(.pUnscaled, .Sign);///< Generic unscaled rotation of foot ScalingNode
    };
    #undef MACRO_CONSTRUCT_ANATOMICAL_FRAME_s
    #undef MACRO_CONSTRUCT_ANATOMICAL_FRAME_A

    AnyRefNode& ScalingNode=AnatomicalFrame ;

    AnyRefNode TaloNavicularJoint =
    {
      sRel = ..Navicular.TaloNavicularJoint.sRel;
      ARel = ..Navicular.TaloNavicularJoint.ARel;
    };
    AnyRefNode MedialMalleolus =
    {
      sRel = .Scale(.Data.MedialMalleolus);
      //    AnyDrawRefFrame drw={ScaleXYZ=2*{0.005,0.005,0.005};RGB={1,0,0};};
    };
    AnyRefNode LateralMalleolus =
    {
      sRel = .Scale(.Data.LateralMalleolus);
      //    AnyDrawRefFrame drw={ScaleXYZ=2*{0.005,0.005,0.005};RGB={1,0,0};};
    };

    //****************
    //Ligaments nodes
    //****************
    AnyRefNode LigTibioTalarPosterior = {
      sRel = .Scale(.Data.LigTibioTalarPosterior);
    };
    AnyRefNode LigTibioTalarAnterior = {
      sRel = .Scale(.Data.LigTibioTalarAnterior);
    };
    AnyRefNode LigTaloFibularPosterior = {
      sRel = .Scale(.Data.LigTaloFibularPosterior);
    };
    AnyRefNode LigTaloFibularAnterior = {
      sRel = .Scale(.Data.LigTaloFibularAnterior);
    };
    AnyRefNode FlexorHallucisLongusViaNode1= {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongusViaNode1);
    };

  }; // End of Talus

  Calcaneus = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.Calcaneus;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;

    AnyRefNode CalcaneoCuboidJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.03,0.03,0.03};RGB={1,0.5,0};};
      sRel = ..Cuboid.CalcaneoCuboidJoint.sRel;
      ARel = ..Cuboid.CalcaneoCuboidJoint.ARel;// *RotMat(7*pi/180,z); // modified
    };
    AnyRefNode SubTalarJointAxisRef =
    {
      sRel = .Scale(.Data.SubTalarJointAxisRef);
      //AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02}*2;RGB={0,0,1};};
    };
    AnyRefNode HeelNode =
    {
      sRel = .Scale(.Data.HeelNode); //Taken from TD leg
    };
    AnyRefNode HeelPlantar =
    {
      sRel = .Scale(.Data.HeelPlantarNode);
    };
    AnyRefNode TuberCalcanei =
    {
      sRel = .Scale(.Data.TuberCalcanei);
      //    AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02}*2;RGB={0,0,1};};
    };
    AnyRefNode MedialProcess =
    {
      sRel = .Scale(.Data.MedialProcess);
      //    AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02}*2;RGB={0,0,1};};
    };
    AnyRefNode HeelFlatNode =
    {
      sRel = .Scale(.Data.HeelFlatNode);
      ARel = RotMat(pi,x)*RotMat(pi/2,y);
      //    AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02};RGB={0,0,1};};
    };
    AnyRefNode HeelContactNodeLow =
    {
      sRel = .Scale(.Data.HeelContactNodeLow);
      ARel = .AnatomicalFrame.ARel;
    };  
    AnyRefNode HeelContactNodeLateral =
    {
      sRel = .Scale(.Data.HeelContactNodeLateral);
    };
    AnyRefNode HeelContactNodeMedial =
    {
      sRel = .Scale(.Data.HeelContactNodeMedial);
    };
    AnyRefNode HeelStrikeNode =
    {
      sRel = .Scale(.Data.HeelStrikeNode);
      ARel = RotMat(pi,x)*RotMat(pi/2,y);
      //    AnyDrawRefFrame drw2={ScaleXYZ={0.02,0.02,0.02};RGB={0,0,1};};
    };
    AnyRefNode SustentaculumTali=
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.SustentaculumTali);
    };
    AnyRefNode CenterNode=
    {
      sRel = .Scale(.Data.CenterNode); //this is sCoM
    };
    AnyRefNode LongitudinalMedialArchNode = {
      sRel = .Scale(.Data.LongitudinalMedialArchNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode LongitudinalLateralArchNode = {
      sRel = .Scale(.Data.LongitudinalLateralArchNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode TendonCalcaneusNode=
    {
      sRel = .Scale(.Data.TendonCalcaneusNode); // from TLEM
    };
    AnyRefNode SoleusMedialis1Node=
    {
      sRel = .Scale(.Data.SoleusMedialis1Node); // from TLEM
    };
    AnyRefNode SoleusMedialis2Node=
    {
      sRel = .Scale(.Data.SoleusMedialis2Node); // from TLEM
    };
    AnyRefNode SoleusMedialis3Node=
    {
      sRel = .Scale(.Data.SoleusMedialis3Node); // from TLEM
    };
    AnyRefNode SoleusLateralis1Node=
    {
      sRel = .Scale(.Data.SoleusLateralis1Node); // from TLEM
    };
    AnyRefNode SoleusLateralis2Node=
    {
      sRel = .Scale(.Data.SoleusLateralis2Node); // from TLEM
    };
    AnyRefNode SoleusLateralis3Node=
    {
      sRel = .Scale(.Data.SoleusLateralis3Node); // from TLEM
    };
    AnyRefNode GastrocnemiusLateralis1Node=
    {
      sRel = .Scale(.Data.GastrocnemiusLateralis1Node); // from TLEM
    };
    AnyRefNode GastrocnemiusMedialis1Node=
    {
      sRel = .Scale(.Data.GastrocnemiusMedialis1Node); // from TLEM
    };
    AnyRefNode Plantaris1Node=
    {
      sRel = .Scale(.Data.Plantaris1Node); // from TLEM
    };
    AnyRefNode TendonCalcaneusSuperiorNode=
    {
      sRel = .Scale(.Data.TendonCalcaneusSuperiorNode); // from TLEM
    };
    AnyRefNode SoleusMedialis1SuperiorNode=
    {
      sRel = .Scale(.Data.SoleusMedialis1SuperiorNode); // from TLEM
    };
    AnyRefNode SoleusMedialis2SuperiorNode=
    {
      sRel = .Scale(.Data.SoleusMedialis2SuperiorNode); // from TLEM
    };
    AnyRefNode SoleusMedialis3SuperiorNode=
    {
      sRel = .Scale(.Data.SoleusMedialis3SuperiorNode); // from TLEM
    };
    AnyRefNode SoleusLateralis1SuperiorNode=
    {
      sRel = .Scale(.Data.SoleusLateralis1SuperiorNode); // from TLEM
    };
    AnyRefNode SoleusLateralis2SuperiorNode=
    {
      sRel = .Scale(.Data.SoleusLateralis2SuperiorNode); // from TLEM
    };
    AnyRefNode SoleusLateralis3SuperiorNode=
    {
      sRel = .Scale(.Data.SoleusLateralis3SuperiorNode); // from TLEM
    };
    AnyRefNode GastrocnemiusLateralis1SuperiorNode=
    {
      sRel = .Scale(.Data.GastrocnemiusLateralis1SuperiorNode); // from TLEM
    };
    AnyRefNode GastrocnemiusMedialis1SuperiorNode=
    {
      sRel = .Scale(.Data.GastrocnemiusMedialis1SuperiorNode); // from TLEM
    };
    AnyRefNode Plantaris1SuperiorNode=
    {
      sRel = .Scale(.Data.Plantaris1SuperiorNode); // from TLEM
    };
    AnyRefNode FlexorHallucisLongusViaNode6=
    {
      AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongusViaNode6);
    };
    AnyRefNode FlexorHallucisLongusViaNode7=
    {
      AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongusViaNode7);
    };
    AnyRefNode FlexorHallucisLongusViaNode8=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongusViaNode8);
    };
    AnyRefNode PeroneusBrevisViaNode3=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusBrevisViaNode3);
    };
    AnyRefNode PeroneusBrevisViaNode4=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusBrevisViaNode4);
    };
    AnyRefNode PeroneusLongusViaNode3=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusLongusViaNode3);
    };
    AnyRefNode PeroneusLongusViaNode4=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusLongusViaNode4);
    };
    AnyRefNode TibialisPosteriorLateralisViaNode8=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorLateralisViaNode8);
    };
    AnyRefNode TibialisPosteriorMedialisViaNode9=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorMedialisViaNode9);
    };
    AnyRefNode TibialisPosteriorViaNode10=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorViaNode10);
    };
    AnyRefNode TibialisPosteriorViaNode11=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorViaNode11);
    };
    AnyRefNode FlexorDigitorumLongusViaNode7=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode7);
    };
    //  Moved from tasrsals to reproduce the extensor retinaculum inferior
    AnyRefNode PeroneusTertiusViaNode3=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusTertiusViaNode3);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode5=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode5);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode5Bis=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode5Bis);
    };
    AnyRefNode ExtensorHallucisLongusViaNode7=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorHallucisLongusViaNode7);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris=
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };
    //  AnyRefNode LigLateralAponeurosisPlantaris=
    //  {
    ////    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
    //    sRel = .Scale({-0.01843697, 0.08972377, ....Sign*0.008106899});
    //  };
    AnyRefNode LigPlantareLongum =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongum);
    };
    AnyRefNode LigTibioCalcaneal = {
      sRel = .SustentaculumTali.sRel;
    };
    AnyRefNode LigCalcaneoFibular = {
      sRel = .Scale(.Data.LigCalcaneoFibular);
    };
    AnyRefNode LigCalcaneoNavicularPlantar1 = {
      //    sRel = .Scale({0.02746646, 0.05083057, ....Sign*-0.01806011});
      sRel = .Scale(.Data.LigCalcaneoNavicularPlantar1);
    };
    AnyRefNode LigCalcaneoNavicularPlantar2 = {
      //    sRel = .Scale({0.0250344, 0.04708043, ....Sign*-0.0131952});
      sRel = .Scale(.Data.LigCalcaneoNavicularPlantar2);
    };
    AnyRefNode LigCalcaneoNavicularPlantar3 = {
      sRel = .Scale(.Data.LigCalcaneoNavicularPlantar3);
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoNavicularPlantar4 = {
      sRel = .Scale(.Data.LigCalcaneoNavicularPlantar4);
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoNavicularPlantar5 = {
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
      sRel = .Scale(.Data.LigCalcaneoNavicularPlantar5);
    };
    AnyRefNode LigCalcaneoNavicularPlantar6 = {
      sRel = .Scale(.Data.LigCalcaneoNavicularPlantar6);
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoCuboidPlantar1 = {
      sRel = .Scale(.Data.LigCalcaneoCuboidPlantar1);
    };
    AnyRefNode LigCalcaneoCuboidPlantar2 = {
      sRel = .Scale(.Data.LigCalcaneoCuboidPlantar2);
    };
    //AnyDrawRefFrame drw = {};

  }; // End of Calcaneus

  Cuboid = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.Cuboid;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode CalcaneoCuboidJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ=4*{0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.Data.CalcaneoCuboidJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel=0.5*(.CalcaneoCuboidJoint.sRel+.RefDist.sRel);
      ARel=RotMat(.CalcaneoCuboidJoint.sRel,.RefDist.sRel,.RefProx.sRel)*RotMat(....Sign*-pi/2,x);
    };
    AnyRefNode TarsoMt4Joint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal4.TarsoMtJoint.sRel;
      ARel = ..Metatarsal4.TarsoMtJoint.ARel; // *RotMat(-8*pi/180,z); // modified
    };
    AnyRefNode TarsoMt5Joint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal5.TarsoMtJoint.sRel;
      ARel = ..Metatarsal5.TarsoMtJoint.ARel; // *RotMat(-10*pi/180,z); // modified
    };
    AnyRefNode TubOsCub =
    {
      //    AnyDrawNode drw={ScaleXYZ={0.003,0.003,0.003};RGB={1,0.5,0};};
      sRel = .Scale(.Data.TubOsCub);
      //    AnyDrawRefFrame drw2 ={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
    };
    AnyRefNode LongitudinalLateralArchNode = {
      sRel = .Scale(.Data.LongitudinalLateralArchNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };

    //***********************
    //Muscles nodes
    //***********************
    AnyRefNode PeroneusLongusViaNode5=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusLongusViaNode5);
    };
    AnyRefNode PeroneusLongusViaNode6=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusLongusViaNode6);
    };
    AnyRefNode PeroneusLongusViaNode7=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusLongusViaNode7);
    };
    AnyRefNode TibialisPosteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorNode);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigPlantareLongumMtII =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongumMtII);
    };
    AnyRefNode LigPlantareLongumMtIII =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongumMtIII);
    };
    AnyRefNode LigPlantareLongumMtIV =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongumMtIV);
    };
    AnyRefNode LigPlantareLongumMtV =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongumMtV);
    };
    AnyRefNode LigCalcaneoCuboidPlantar1 = {
      sRel = .Scale(.Data.LigCalcaneoCuboidPlantar1);
    };
    AnyRefNode LigCalcaneoCuboidPlantar2 = {
      sRel = .Scale(.Data.LigCalcaneoCuboidPlantar2);
    };
    //  AnyDrawRefFrame drw = {};

  }; // End of cuboid

  Navicular = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.Navicular;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode TaloNavicularJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ=4*{0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.Data.TaloNavicularJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0.5,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TaloNavicularJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.TaloNavicularJoint.sRel,.RefDist.sRel,{1.0,0.0,-....Sign*0.1});
    };
    AnyRefNode MedCuneiNaviJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = ..MedialCuneiform.CuneiNaviJoint.sRel;
      ARel = ..MedialCuneiform.CuneiNaviJoint.ARel;
    };
    AnyRefNode IntCuneiNaviJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = ..IntermediateCuneiform.CuneiNaviJoint.sRel;
      ARel = ..IntermediateCuneiform.CuneiNaviJoint.ARel;
    };
    AnyRefNode LatCuneiNaviJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = ..LateralCuneiform.CuneiNaviJoint.sRel;
      ARel = ..LateralCuneiform.CuneiNaviJoint.ARel;
    };
    AnyRefNode LongitudinalMedialArchNode = {
      sRel = .Scale(.Data.LongitudinalMedialArchNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode TibialisAnteriorViaNode2=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisAnteriorViaNode2);
    };
    AnyRefNode TibialisPosteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorNode);
    };
    AnyRefNode TibialisPosteriorViaNode11=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorViaNode11);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigTibioNavicular = {
      sRel = .Scale(.Data.LigTibioNavicular);
    };
    AnyRefNode LigCalcaneoNavicularPlantar1 = {
      // sRel = .Scale({0.03073173, 0.03206972, ....Sign*-0.01952226});
      sRel = .Scale(.Data.LigCalcaneoNavicularPlantar1);

    };
    AnyRefNode LigCalcaneoNavicularPlantar2 = {
      //    sRel = .Scale({0.02675282, 0.03336712, ....Sign*-0.01096544});
      sRel = .Scale(.Data.LigCalcaneoNavicularPlantar2);
    };
    AnyRefNode LigCalcaneoNavicularPlantar3 = {
      sRel =.Scale(.Data.LigCalcaneoNavicularPlantar3);
      //  AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoNavicularPlantar4 = {
      sRel =.Scale(.Data.LigCalcaneoNavicularPlantar4);
      //  AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoNavicularPlantar5 = {
      sRel =.Scale(.Data.LigCalcaneoNavicularPlantar5);
      //     AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode LigCalcaneoNavicularPlantar6 = {
      sRel =.Scale(.Data.LigCalcaneoNavicularPlantar6);
      //  AnyDrawNode drw ={ScaleXYZ =0.0005*{1,1,1};};
    };
    AnyRefNode ExtensorHallucisLongusViaNode7=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorHallucisLongusViaNode7);
    };

  }; // End of Navicular

  MedialCuneiform = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.MedialCuneiform;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode CuneiNaviJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1,0,0};};
      sRel = .Scale(.Data.CuneiNaviJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.CuneiNaviJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.CuneiNaviJoint.sRel,.RefDist.sRel,{1.0,0.0,-....Sign*0.1});
    };
    AnyRefNode TarsoMtJoint =
    {
      AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal1.TarsoMtJoint.sRel;
      ARel = ..Metatarsal1.TarsoMtJoint.ARel;
    };
    AnyRefNode FDLSegNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FDLSegNode);
    };

    //***********************
    //Muscles nodes
    //***********************
    AnyRefNode ExtensorHallucisLongusViaNode8=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorHallucisLongusViaNode8);
    };
    AnyRefNode TibialisAnteriorViaNode3=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      //    sRel = .JntTarsoMt.sRel + {0, 0, ....Sign*-0.014}*.JntTarsoMt.ARel';
      sRel = .Scale(.Data.TibialisAnteriorViaNode3);
    };
    AnyRefNode TibialisAnteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisAnteriorNode);
    };
    AnyRefNode PeroneusLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusLongusNode);
    };
    AnyRefNode TibialisPosteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorNode);
    };

    //***********************
    //Ligaments nodes
    //***********************

  }; // End of MedialCuneiform

  IntermediateCuneiform = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.IntermediateCuneiform;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode CuneiNaviJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={0,0,0};};
      sRel = .Scale(.Data.CuneiNaviJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //  AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.CuneiNaviJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.CuneiNaviJoint.sRel,.RefDist.sRel,{1.0,0.0, ....Sign*0.1});
    };
    AnyRefNode TarsoMtJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ=10*{0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal2.TarsoMtJoint.sRel;
      ARel = ..Metatarsal2.TarsoMtJoint.ARel;

    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode TibialisPosteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorNode);
    };

    //***********************
    //Ligaments nodes
    //***********************

  }; // End of IntermediateCuneiform

  LateralCuneiform = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.LateralCuneiform;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode CuneiNaviJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={0,0,0};};
      sRel = .Scale(.Data.CuneiNaviJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.CuneiNaviJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.CuneiNaviJoint.sRel,.RefDist.sRel,{1.0,0.0, ....Sign*0.4});
    };
    AnyRefNode TarsoMtJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,1};};
      sRel = ..Metatarsal3.TarsoMtJoint.sRel;
      ARel = ..Metatarsal3.TarsoMtJoint.ARel;
    };
    //  AnyRefNode ArticularLateralCunieform={
    //    sRel={0.02,0.01,....Sign*(0.013)};
    //    ARel = RotMat(....Sign*-30*pi/180,x)*RotMat(-10*pi/180,z);
    //  };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode TibialisPosteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorNode);
    };

    //***********************
    //Ligaments nodes
    //***********************

  }; // End of LateralCuneiform


  //************************************************
  //Metatarsal bones
  //************************************************

  Metatarsal1 = {

    AnyFolder &FootType = .FootType;

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.Metatarsal1;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode TarsoMtJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.TarsoMtJoint*.FootType.MetaScale);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefDist*.FootType.MetaScale);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefProx*.FootType.MetaScale);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,{1.0,0.0,-....Sign*0.1});
    };
    AnyRefNode MtPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = .Scale(.Data.MtPhalJoint*.FootType.MetaScale);
      ARel = ..ProximalPhalange1.MtPhalJoint.ARel;
    };
    AnyRefNode MtPhalJointTop ={
      sRel = .MtPhalJoint.sRel+({0, 0.02,0})*.MtPhalJoint.ARel';
      AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
    };
    AnyRefNode ToeMedialContactNode =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.ToeMedialContactNode*.FootType.MetaScale);
      ARel = .AnatomicalFrame.ARel;
    };    
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.Data.MTHeadPlantarNode)*.FootType.MetaScale;
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.Data.MTBasePlantarNode)*.FootType.MetaScale;
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTHeadMedialNode = {
      sRel = .Scale(.Data.MTHeadMedialNode)*.FootType.MetaScale;
      //    AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode Metatarsal1Plantar = {
      sRel = .Scale(.Data.Metatarsal1PlantarNode);
    };
    AnyRefNode Metatarsal1Contact = {
      sRel = .Scale(.Data.Metatarsal1ContactNode);
    };
    AnyRefFrame &MetatarsalJoint1Node = MtPhalJoint;
    AnyRefNode ToeJoint = {
      sRel = .MtPhalJoint.sRel;
      ARel = .ScalingNode.ARel;
    };
    
    //***********************
    //Muscles nodes
    //***********************
    AnyRefNode ExtensorHallucisLongusViaNode9=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorHallucisLongusViaNode9*.FootType.MetaScale);
    };
    AnyRefNode FlexorHallucisLongusViaNode9=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongusViaNode9*.FootType.MetaScale);
    };
    AnyRefNode TibialisAnteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisAnteriorNode*.FootType.MetaScale);
    };
    AnyRefNode PeroneusLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusLongusNode*.FootType.MetaScale);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris*.FootType.MetaScale);
    };
    AnyRefNode LigMtTransversumProfundum =
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundum*.FootType.MetaScale);
    };
    AnyRefNode LigMtTransversumProfundumVia1 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia1*.FootType.MetaScale);
    };
    AnyRefNode LigMtTransversumProfundumVia2 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia2*.FootType.MetaScale);
    };

  }; // End of Metatarsal1

  Metatarsal2 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.Metatarsal2;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode TarsoMtJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.TarsoMtJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode MtPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = ..ProximalPhalange2.MtPhalJoint.sRel;
      ARel = ..ProximalPhalange2.MtPhalJoint.ARel;
    };
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.Data.MTHeadPlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.Data.MTBasePlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode Metatarsal2Plantar = {
      sRel = .Scale(.Data.Metatarsal2PlantarNode);
    };
    AnyRefNode Metatarsal2Contact = {
      sRel = .Scale(.Data.Metatarsal2ContactNode);
    };
    AnyRefFrame &MetatarsalJoint2Node = MtPhalJoint;

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode TibialisPosteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorNode);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode6=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode6);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode6Bis=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode6Bis);
    };
    AnyRefNode FlexorDigitorumLongusViaNode9=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode9);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };
    AnyRefNode LigPlantareLongum =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongum);
    };
    AnyRefNode LigMtTransversumProfundum =
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundum);
    };
    AnyRefNode LigMtTransversumProfundumVia1 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia1);
    };
    AnyRefNode LigMtTransversumProfundumVia2 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia2);
    };

  }; // End of Metatarsal2

  Metatarsal3 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.Metatarsal3;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode TarsoMtJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.TarsoMtJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode MtPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = ..ProximalPhalange3.MtPhalJoint.sRel;
      ARel = ..ProximalPhalange3.MtPhalJoint.ARel;
    };
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.Data.MTHeadPlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.Data.MTBasePlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefFrame &MetatarsalJoint3Node = MtPhalJoint;

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode TibialisPosteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorNode);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode9=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode9);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode9Bis=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode9Bis);
    };
    AnyRefNode FlexorDigitorumLongusViaNode12=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode12);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };
    AnyRefNode LigPlantareLongum =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongum);
    };
    AnyRefNode LigMtTransversumProfundum =
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundum);
    };
    AnyRefNode LigMtTransversumProfundumVia1 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia1);
    };
    AnyRefNode LigMtTransversumProfundumVia2 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia2);
    };

  }; // End of Metatarsal3

  Metatarsal4 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.Metatarsal4;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode TarsoMtJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.TarsoMtJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode MtPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = ..ProximalPhalange4.MtPhalJoint.sRel;
      ARel = ..ProximalPhalange4.MtPhalJoint.ARel;
    };
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.Data.MTHeadPlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.Data.MTBasePlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefFrame &MetatarsalJoint4Node = MtPhalJoint;

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode TibialisPosteriorNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.TibialisPosteriorNode);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode12=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode12);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode12Bis=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode12Bis);
    };
    AnyRefNode FlexorDigitorumLongusViaNode15=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode15);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };
    AnyRefNode LigPlantareLongum =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongum);
    };
    AnyRefNode LigMtTransversumProfundum =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundum);
    };
    AnyRefNode LigMtTransversumProfundumVia1 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia1);
    };
    AnyRefNode LigMtTransversumProfundumVia2 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia2);
    };

  }; // End of Metatarsal4

  Metatarsal5 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.Metatarsal5;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode TarsoMtJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*4;RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.TarsoMtJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefDist2 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefDist2);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.TarsoMtJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.TarsoMtJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode CenterNode2={
      //     AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*2;RGB={0,1,0};};
      sRel = 0.5*(.RefProx.sRel+.RefDist2.sRel);
      ARel = RotMat(.RefProx.sRel,.RefDist2.sRel,{1.0,0.0,0.0});
    };
    AnyRefNode MtPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = ..ProximalPhalange5.MtPhalJoint.sRel;
      ARel = ..ProximalPhalange5.MtPhalJoint.ARel;
    };
    AnyRefNode ToeLateralContactNode =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1.0,0.0,1.0};};
      sRel = .Scale(.Data.ToeLateralContactNode);
      ARel = .AnatomicalFrame.ARel;
    };
    AnyRefNode FDLSegNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FDLSegNode);
    };
    //For arch driving
    AnyRefNode MTHeadPlantarNode = {
      sRel = .Scale(.Data.MTHeadPlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTBasePlantarNode = {
      sRel = .Scale(.Data.MTBasePlantarNode);
      //AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode MTHeadLateralNode = {
      sRel = .Scale(.Data.MTHeadLateralNode);
      //      AnyDrawRefFrame drw = {ScaleXYZ = 0.03*{1,1,1};};
    };
    AnyRefNode Metatarsal5Plantar = {
      sRel = .Scale(.Data.Metatarsal5PlantarNode);
    };
    AnyRefNode Metatarsal5Contact = {
      sRel = .Scale(.Data.Metatarsal5ContactNode);
    };
    AnyRefFrame &MetatarsalJoint5Node = MtPhalJoint;

    //***********************
    //Muscles nodes
    //***********************1

    AnyRefNode PeroneusBrevis1Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusBrevis1Node);
    };
    AnyRefNode PeroneusBrevis2Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusBrevis2Node);
    };
    AnyRefNode PeroneusBrevis3Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusBrevis3Node);
    };
    AnyRefNode PeroneusTertius1Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusTertius1Node);
    };
    AnyRefNode PeroneusTertius2Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusTertius2Node);
    };
    AnyRefNode PeroneusTertius3Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.PeroneusTertius3Node);
    };
    AnyRefNode ExtensorDigitorumLongusViaNode15=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode15);
    };
    AnyRefNode FlexorDigitorumLongusViaNode18=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode18);
    };

    //***********************
    //Ligaments nodes
    //***********************1

    AnyRefNode LigAponeurosisPlantaris =
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };
    //  AnyRefNode LigLateralAponeurosisPlantaris =
    //  {
    ////    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
    //    sRel = .Scale({-0.00999591, 0.02399151, ....Sign*0.03768708});
    //  };
    AnyRefNode LigPlantareLongum =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigPlantareLongum);
    };
    AnyRefNode LigMtTransversumProfundum =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundum);
    };
    AnyRefNode LigMtTransversumProfundumVia1 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia1);
    };
    AnyRefNode LigMtTransversumProfundumVia2 =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigMtTransversumProfundumVia2);
    };

  }; // End of Metatarsal5


  //************************************************
  //Proximal Phalanges  bones
  //************************************************

  ProximalPhalange1 = {

    AnyFolder &FootType = .FootType;

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.ProximalPhalange1;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode MtPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ=10*{0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.MtPhalJoint*.FootType.ProxPhalScale);
      ARel = .CenterNode.ARel*RotMat(....Sign*-35*pi/180,x);
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.RefDist*.FootType.ProxPhalScale);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,{0.1,0,0} );
    };
    AnyRefNode DistPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      // sRel = .Scale({-0.001083079, -0.10166927, ....Sign*-0.008109532}*.FootType.ProxPhalScale);
      sRel =..DistalPhalange1.DistPhalJoint.sRel;
      ARel = ..DistalPhalange1.DistPhalJoint.ARel;
    };
    AnyRefNode RefDistTop ={
      sRel = .DistPhalJoint.sRel+({0, 0.01,0})*.DistPhalJoint.ARel';
      AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
    };
    AnyRefNode ToeMedialContactNode = {
      sRel = .Scale(.Data.ToeMedialContactNode);
      ARel = .AnatomicalFrame.ARel;
    };
    //***********************
    //Muscles nodes
    //***********************

     AnyRefNode ExtensorHallucisLongusViaNode10=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorHallucisLongusViaNode10*.FootType.ProxPhalScale);
    };
    AnyRefNode FlexorHallucisLongusViaNode10=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongusViaNode10*.FootType.ProxPhalScale);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris*.FootType.ProxPhalScale);
    };

  }; // End of ProximalPhalanges1

  ProximalPhalange2 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.ProximalPhalange2;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode MtPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.MtPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode ProxPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = ..MiddlePhalange2.ProxPhalJoint.sRel;
      ARel = ..MiddlePhalange2.ProxPhalJoint.ARel;
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusViaNode7=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode7);
    };
    AnyRefNode FlexorDigitorumLongusViaNode10=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode10);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };

  }; // End of ProximalPhalanges2

  ProximalPhalange3 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.ProximalPhalange3;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode MtPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.MtPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode ProxPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = ..MiddlePhalange3.ProxPhalJoint.sRel;
      ARel = ..MiddlePhalange3.ProxPhalJoint.ARel;
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusViaNode10=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode10);
    };
    AnyRefNode FlexorDigitorumLongusViaNode13=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode13);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };

  }; // End of ProximalPhalanges3

  ProximalPhalange4 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.ProximalPhalange4;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode MtPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.MtPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode ProxPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = ..MiddlePhalange4.ProxPhalJoint.sRel;
      ARel = ..MiddlePhalange4.ProxPhalJoint.ARel;
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusViaNode13=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode13);
    };
    AnyRefNode FlexorDigitorumLongusViaNode16=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode16);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };

  }; // End of ProximalPhalanges4

  ProximalPhalange5 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.ProximalPhalange5;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode MtPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.MtPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0.0,1.0,0.0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.MtPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.MtPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode ProxPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = ..MiddlePhalange5.ProxPhalJoint.sRel;
      ARel = ..MiddlePhalange5.ProxPhalJoint.ARel;
    };
    AnyRefNode ToeLateralContactNode = {
      sRel = .Scale(.Data.ToeLateralContactNode);
      ARel = .AnatomicalFrame.ARel;
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusViaNode16=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode16);
    };
    AnyRefNode FlexorDigitorumLongusViaNode19=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode19);
    };

    //***********************
    //Ligaments nodes
    //***********************

    AnyRefNode LigAponeurosisPlantaris =
    {
      //   AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={1.0,1.0,0.0};};
      sRel = .Scale(.Data.LigAponeurosisPlantaris);
    };

  }; // End of ProximalPhalanges5


  //************************************************
  //Middle Phalanges  bones
  //************************************************

  MiddlePhalange2 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.MiddlePhalange2;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode ProxPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.ProxPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.ProxPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.ProxPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode DistPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = ..DistalPhalange2.DistPhalJoint.sRel;
      ARel = ..DistalPhalange2.DistPhalJoint.ARel;
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusViaNode8=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode8);
    };
    AnyRefNode ExtensorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusNode);
    };
    AnyRefNode FlexorDigitorumLongusViaNode11=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode11);
    };

  }; // End of MiddlePhalanges2

  MiddlePhalange3 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.MiddlePhalange3;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode ProxPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.ProxPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.ProxPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.ProxPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode DistPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = ..DistalPhalange3.DistPhalJoint.sRel;
      ARel = ..DistalPhalange3.DistPhalJoint.ARel;
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusViaNode11=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode11);
    };
    AnyRefNode ExtensorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusNode);
    };
    AnyRefNode FlexorDigitorumLongusViaNode14=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode14);
    };

  }; // End of MiddlePhalanges3

  MiddlePhalange4 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.MiddlePhalange4;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode ProxPhalJoint =
    {
      AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.ProxPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.ProxPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.ProxPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode DistPhalJoint =
    {
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = ..DistalPhalange4.DistPhalJoint.sRel;
      ARel = ..DistalPhalange4.DistPhalJoint.ARel;
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusViaNode14=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode14);
    };
    AnyRefNode ExtensorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusNode);
    };
    AnyRefNode FlexorDigitorumLongusViaNode17=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode17);
    };

  }; // End of MiddlePhalanges4

  MiddlePhalange5 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.MiddlePhalange5;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode ProxPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.ProxPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={1,0,0};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.ProxPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.ProxPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode DistPhalJoint =
    {
      //  AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = ..DistalPhalange5.DistPhalJoint.sRel;
      ARel = ..DistalPhalange5.DistPhalJoint.ARel;
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusViaNode17=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusViaNode17);
    };
    AnyRefNode ExtensorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusNode);
    };
    AnyRefNode FlexorDigitorumLongusViaNode20=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusViaNode20);
    };

  }; // End of MiddlePhalanges5


  //************************************************
  //Distal Phalanges  bones
  //************************************************

  DistalPhalange1 = {

    AnyFolder &FootType = .FootType;

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.DistalPhalange1;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode DistPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.DistPhalJoint*.FootType.DistPhalScale);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefDist*.FootType.DistPhalScale);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,{1.0,0.0,0.0});
    };
    AnyRefNode ToeTip =
    {
      //     AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,1};};
      sRel = .Scale(.Data.ToeTip*.FootType.DistPhalScale);
    };
    AnyRefNode GroundContactNode =
    {
      //     AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,1};};
      sRel = .Scale(.Data.GroundContactNode*.FootType.DistPhalScale);
    };
    AnyRefNode BigToeNode = {
      sRel = .ToeTip.sRel;
      ARel = .AnatomicalFrame.ARel;
    };
    
    //***********************
    //Muscles nodes
    //***********************
    AnyRefNode ExtensorHallucisLongus1Node =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorHallucisLongus1Node*.FootType.DistPhalScale);
    };
    AnyRefNode ExtensorHallucisLongus2Node =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorHallucisLongus2Node*.FootType.DistPhalScale);
    };
    AnyRefNode ExtensorHallucisLongus3Node =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorHallucisLongus3Node*.FootType.DistPhalScale);
    };
    AnyRefNode FlexorHallucisLongus1Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongus1Node*.FootType.DistPhalScale);
    };
    AnyRefNode FlexorHallucisLongus2Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongus2Node*.FootType.DistPhalScale);
    };
    AnyRefNode FlexorHallucisLongus3Node=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorHallucisLongus3Node*.FootType.DistPhalScale);
    };

  }; // End of DistalPhalanges1

  DistalPhalange2 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.DistalPhalange2;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode DistPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.DistPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //     AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*2;RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };
    AnyRefNode ToeTip =
    {
      sRel = .Scale(.Data.ToeTip);
      //AnyDrawRefFrame drw2={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,1};};
    };
    AnyRefNode GroundContactNode =
    {
      //     AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,1};};
      sRel = .Scale(.Data.GroundContactNode);
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusNode);
    };
    AnyRefNode FlexorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusNode);
    };
    AnyRefNode &ExtensorDigitorumLongus1Node = ExtensorDigitorumLongusNode;

  }; // End of DistalPhalanges2

  DistalPhalange3 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.DistalPhalange3;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode DistPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.DistPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //     AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*2;RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusNode);
    };
    AnyRefNode FlexorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusNode);
    };

  }; // End of DistalPhalanges3

  DistalPhalange4 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.DistalPhalange4;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode DistPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.DistPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //     AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005}*2;RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusNode);
    };
    AnyRefNode FlexorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusNode);
    };

  }; // End of DistalPhalanges4

  DistalPhalange5 = {

    AnyVar Sign = .Sign;
    AnyFolder &Data = .Data.DistalPhalange5;

    AnyRefNode &AnatomicalFrame = .AnatomicalFrame;
    AnyRefNode& ScalingNode=AnatomicalFrame ;


    AnyRefNode DistPhalJoint =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.DistPhalJoint);
      ARel = .CenterNode.ARel;
    };
    AnyRefNode RefDist =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefDist);
    };
    AnyRefNode RefProx =
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,0,1};};
      sRel = .Scale(.Data.RefProx);
    };
    //Segment center node
    AnyRefNode CenterNode={
      //    AnyDrawRefFrame drw={ScaleXYZ={0.005,0.005,0.005};RGB={0,1,0};};
      sRel = 0.5*(.DistPhalJoint.sRel+.RefDist.sRel);
      ARel = RotMat(.DistPhalJoint.sRel,.RefDist.sRel,.RefProx.sRel);
    };

    //***********************
    //Muscles nodes
    //***********************

    AnyRefNode ExtensorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.ExtensorDigitorumLongusNode);
    };
    AnyRefNode FlexorDigitorumLongusNode=
    {
      //AnyDrawRefFrame drw={ScaleXYZ={0.01,0.01,0.01};RGB={0,0,0};};
      sRel = .Scale(.Data.FlexorDigitorumLongusNode);
    };

  }; // End of DistalPhalanges5


}; // Foot
