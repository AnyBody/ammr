LegCalibrationStudy LegCalibration1Left(
  BodyModelRef=Main.HumanModel.BodyModel,
  Side=Left,
) = {
  nStep = .LegCalibration1Right.nStep;
  
  MuscleArr = ObjSearch(
    &..BodyModel.Left.Leg.Mus,
    {
      "AdductorMagnus*.*",
      "AdductorLong*.*",
      "AdductorBrevis*.*",
      "Pectineus.*",
      "Gracilis.*",
      "TensorFasciaeLatae.*",
    }, 
    "AnyMuscle"
  );
  
  RminMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMinDefault);
  RmaxMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMaxDefault);
  
  AnyObjectPtrArray HipPositions = .LegCalibration1Right.HipPositions;
  AnyObjectPtrArray KneePositions = .LegCalibration1Right.KneePositions;
  AnyObjectPtrArray AnklePositions = .LegCalibration1Right.AnklePositions;
  AnyObjectPtrArray SubTalarPositions = .LegCalibration1Right.SubTalarPositions;
};


LegCalibrationStudy LegCalibration2Left(
  BodyModelRef=Main.HumanModel.BodyModel,
  Side=Left,
) = {
  nStep = .LegCalibration2Right.nStep;
  
  MuscleArr = ObjSearch(
    &..BodyModel.Left.Leg.Mus,
    {
      "Gluteus*.*",
      "Piriformis.*",
      "Gemellus.*",
      "Obturator*.*",
      "QuadratusFem*.*",
    }, 
    "AnyMuscle"
  );
  
  RminMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMinDefault);
  RmaxMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMaxDefault);
  
  AnyObjectPtrArray HipPositions = .LegCalibration2Right.HipPositions;
  AnyObjectPtrArray KneePositions = .LegCalibration2Right.KneePositions;
  AnyObjectPtrArray AnklePositions = .LegCalibration2Right.AnklePositions;
  AnyObjectPtrArray SubTalarPositions = .LegCalibration2Right.SubTalarPositions;
};

LegCalibrationStudy LegCalibration3Left(
  BodyModelRef=Main.HumanModel.BodyModel,
  Side=Left,
) = {
  nStep = .LegCalibration3Right.nStep;
  
  MuscleArr = ObjSearch(
    {&..BodyModel.Left.Leg.Mus,  &..BodyModel.Trunk.Muscles.Left,},
    {
      "Iliacus*.*",
      "PsoasMajor*.*",
    }, 
    "AnyMuscle"
  );
  
  RminMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMinDefault);
  RmaxMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMaxDefault);
  
  AnyObjectPtrArray HipPositions = .LegCalibration3Right.HipPositions;
  AnyObjectPtrArray KneePositions = .LegCalibration3Right.KneePositions;
  AnyObjectPtrArray AnklePositions = .LegCalibration3Right.AnklePositions;
  AnyObjectPtrArray SubTalarPositions = .LegCalibration3Right.SubTalarPositions;
};


LegCalibrationStudy LegCalibration4Left(
  BodyModelRef=Main.HumanModel.BodyModel,
  Side=Left,
) = {
  nStep = .LegCalibration4Right.nStep;
  
  MuscleArr = ObjSearch(
    &..BodyModel.Left.Leg.Mus,
    {
      "RectusFem*.*",
      "BicepsFem*.*",
      "Semitend*.*",
      "Semimem*.*",
      "Sartorius.*",
    }, 
    "AnyMuscle"
  );
  
  RminMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMinDefault);
  RmaxMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMaxDefault);
  
  AnyObjectPtrArray HipPositions = .LegCalibration4Right.HipPositions;
  AnyObjectPtrArray KneePositions = .LegCalibration4Right.KneePositions;
  AnyObjectPtrArray AnklePositions = .LegCalibration4Right.AnklePositions;
  AnyObjectPtrArray SubTalarPositions = .LegCalibration4Right.SubTalarPositions;
};

LegCalibrationStudy LegCalibration5Left(
  BodyModelRef=Main.HumanModel.BodyModel,
  Side=Left,
) = {
  nStep = .LegCalibration6Right.nStep;
  
  MuscleArr = ObjSearch(
    &..BodyModel.Left.Leg.Mus,
    {
      "Vastus*.*",
      "Popliteus.*",
    }, 
    "AnyMuscle"
  );
  
  RminMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMinDefault);
  RmaxMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMaxDefault);
  
  AnyObjectPtrArray HipPositions = .LegCalibration6Right.HipPositions;
  AnyObjectPtrArray KneePositions = .LegCalibration6Right.KneePositions;
  AnyObjectPtrArray AnklePositions = .LegCalibration6Right.AnklePositions;
  AnyObjectPtrArray SubTalarPositions = .LegCalibration6Right.SubTalarPositions;
};

LegCalibrationStudy LegCalibration6Left(
  BodyModelRef=Main.HumanModel.BodyModel,
  Side=Left,
) = {
  nStep = .LegCalibration7Right.nStep;
  
  MuscleArr = ObjSearch(
    &..BodyModel.Left.Leg.Mus,
    {
      "TibialisAnt*.*",
      "TibialisPosteriorMed*.*",
      "ExtensorDigi*.*",
      "ExtensorHall*.*",
      "FlexorDigi*.*",
      "FlexorHall*.*",
      "Peroneus*.*",
      "Plantaris.*",
      "Gastroc*.*",
    },
    "AnyMuscle"
  );
  
  RminMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMinDefault);
  RmaxMuscleFiber = repmat(NumElemOf(MuscleArr), .RValues.RMaxDefault);
  
  AnyObjectPtrArray HipPositions = .LegCalibration7Right.HipPositions;
  AnyObjectPtrArray KneePositions = .LegCalibration7Right.KneePositions;
  AnyObjectPtrArray AnklePositions = .LegCalibration7Right.AnklePositions;
  AnyObjectPtrArray SubTalarPositions = .LegCalibration7Right.SubTalarPositions;
};

LegCalibrationStudy LegCalibration7Left(
  BodyModelRef = Main.HumanModel.BodyModel,
  Side = Left,
) = {
  nStep = .LegCalibration7Right.nStep;
  
  MuscleArr = ObjSearch(
    &..BodyModel.Left.Leg.Mus,
    {
      "TibialisPosteriorLat*.*",
      "Soleus*.*",
    },
    "AnyMuscle"
  );
  
  RminMuscleFiber = repmat(NumElemOf(MuscleArr), 1.0);
  RmaxMuscleFiber = repmat(NumElemOf(MuscleArr), 1.2);
  
  AnyObjectPtrArray HipPositions = .LegCalibration7Right.HipPositions;
  AnyObjectPtrArray KneePositions = .LegCalibration7Right.KneePositions;
  AnyObjectPtrArray AnklePositions = .LegCalibration7Right.AnklePositions;
  AnyObjectPtrArray SubTalarPositions = .LegCalibration7Right.SubTalarPositions;
};

CalibrationSequence = {
  AnyOperation &Cal1Left = .LegCalibration1Left.FiberAndTendonLengthAdjustment;
  AnyOperation &Cal2Left = .LegCalibration2Left.FiberAndTendonLengthAdjustment;
  AnyOperation &Cal3Left = .LegCalibration3Left.FiberAndTendonLengthAdjustment;
  AnyOperation &Cal4Left = .LegCalibration4Left.FiberAndTendonLengthAdjustment;
  AnyOperation &Cal5Left = .LegCalibration5Left.FiberAndTendonLengthAdjustment;
  AnyOperation &Cal6Left = .LegCalibration6Left.FiberAndTendonLengthAdjustment;
  AnyOperation &Cal7Left = .LegCalibration7Left.FiberAndTendonLengthAdjustment;
};