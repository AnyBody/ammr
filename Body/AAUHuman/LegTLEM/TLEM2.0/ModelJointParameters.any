/*
  This dataset is part of The TLEMsafe Project Dataset. The dataset was
  created during the TLEMsafe project (www.tlemsafe.eu) funded by the
  European Commission under Grant Agreement (no. 247860) and under the
  TLEMsafe Consortium Agreement.

  Use the following paper when citing:
    Carbone, V., Fluit, R., Pellikaan, P., van der Krogt, M.M., Janssen, D.,
    Damsgaard, M., Vigneron, L., Feilkas, T., Koopman, H.F.J.M., Verdonschot, N., 2015.
    TLEM 2.0 - a comprehensive musculoskeletal geometry dataset for
    subject-specific modeling of lower extremity.
    J. Biomech. 48, 734-741. doi:10.1016/j.jbiomech.2014.12.034
*/

Pelvis = {
  AnyVec3 HipJoint = {-0.0338, -0.0807, 0.0843}*.TF';
  AnyVec3 HipJointBoneFitted = {-0.03697295, -0.07767031, 0.08159202}*.TF';
  AnyVec3 RASIS = AsisIpsilateral*.TF';
  AnyVec3 LASIS = AsisColateral*.TF';
  AnyVec3 RPSIS = PsisIpsilateral*.TF';
  AnyVec3 LPSIS = PsisColateral*.TF';
  AnyVec3 RPT = PubicTubercleIpsilateral*.TF';
  AnyVec3 LPT = PubicTubercleColateral*.TF';
  
};

Thigh = {
  AnyFunTransform3D &Scale = ..Seg.Thigh.Scale;
  AnyVec3 HipJoint = {-0,   0.359087741410625,   0}*.TF';
  AnyVec3 HipJointBoneFitted = {-0.004290743, 0.3616561, -0.0006287179}*.TF';

  AnyVec3 KneeJoint = {0.002171389,   0.006685766, 0}*.TF';
  AnyVec3 KneeJointAxis = ..Sign*{0.0487755, -0.04631672, -0.9977353}*.TF'/vnorm({0.0487755, -0.04631672, -0.9977353});

  AnyVec3 PatellaFemurJoint ={ 0.005458221, 0.005741691,0}*.TF';
  AnyVec3 PatellaFemurJointAxis = ..Sign*{0.1143518,-0.05854474, -0.9984416}*.TF'/vnorm({0.1143518,-0.05854474, -0.9984416});

};

Patella = {
  AnyFunTransform3D &Scale = ..Seg.Patella.Scale;
  AnyVec3 PatellaFemurJoint = { -0.03663476, -0.005972708, 0.002046017}*.TF';
  AnyVec3 PatellaFemurJointAxis = ..Sign*{0.1143518,-0.05854474, -0.9984416}*.TF'/vnorm({0.1143518,-0.05854474, -0.9984416});

  AnyVec3 HipJoint = {0.0, 0.0, 0.0}*.TF';
};

Shank = {
  AnyFunTransform3D &Scale = ..Seg.Shank.Scale;
  AnyVec3 KneeJoint = { -0.01021331, 0.366972, -0.001585396}*.TF';
  AnyVec3 KneeJointAxis = ..Sign*{0.04877549, -0.04631671, -0.9977353}*.TF'/vnorm({0.04877549, -0.04631671, -0.9977353});

  AnyVec3 AnkleJoint =   {0.005204087, -0.01467614, 0}*.TF';
  AnyVec3 AnkleJointAxis = ..Sign*{0.362799, 0.1304906, -0.9226858}*.TF'/vnorm({0.362799, 0.1304906, -0.9226858});

  AnyVec3 LateralFemuralCondyleInNeutralConf = EpicondylusFemorisLateralis;
  AnyVec3 MedialFemuralCondyleInNeutralConf = EpicondylusFemorisMedialis;
};

Talus = {
  AnyFunTransform3D &Scale = ..Seg.Talus.Scale;
  AnyFunTransform3D &FootScale = ..Seg.Foot.Scale;
  AnyFunTransform3D &ShankScale = ..Seg.Shank.Scale;

  AnyVec3 SubTalarJoint = { -0.006535063, -0.02434153, 0.005824743}*.TF';
  AnyVec3 SubTalarJointAxis = { 0.8784254,  0.4637787, 0.1152306}*.TF';

  AnyVec3 AnkleJoint =   { -0.001330976, -0.011262,  0.001447663}*.TF';
  AnyVec3 AnkleJointAxis = ..Sign*{0.362799, 0.1304906, -0.9226858}*.TF'/vnorm({0.362799, 0.1304906, -0.9226858});

  /// Subtalar joint position in Talus in a neutral (standing reference) posture
  AnyVec3 KneeJointInNeutralConfig = ..Seg.Shank.StdPar.KneeJoint;

};

Foot = {
  AnyFunTransform3D &Scale = ..Seg.Foot.Scale;
  AnyFunTransform3D &ShankScale = ..Seg.Shank.Scale;

  AnyVec3 SubTalarJoint = {0,0,0};
  AnyVec3 SubTalarJointAxis = { 0.8784254,  0.4637787, 0.1152306}*.TF'/vnorm({ 0.8784254,  0.4637787, 0.1152306});

  AnyVec3 MetatarsalJoint1Node = {0.135, -0.032, -0.0196}*.TF';  //< Estimated point. Not part of the original dataset.
  AnyVec3 MetatarsalJoint2Node = {0.131, -0.035,  0.000}*.TF';   //< Estimated point. Not part of the original dataset.
  AnyVec3 MetatarsalJoint3Node = {0.128, -0.037,  0.012}*.TF';   //< Estimated point. Not part of the original dataset.
  AnyVec3 MetatarsalJoint4Node = {0.123, -0.039,  0.023}*.TF';   //< Estimated point. Not part of the original dataset.
  AnyVec3 MetatarsalJoint5Node = {0.114, -0.039, 0.0330}*.TF';   //< Estimated point. Not part of the original dataset.

  AnyVec3 ToeJoint = MetatarsalJoint1Node*.TF'; //< Estimated point. Not part of the original dataset.

};
