/*  
  This dataset is based on the AMMR 2.2 arm muscle parameters. The parameters 
  were collected from hardcoded values in the old model and added  here to 
  create a single file containing all arm model muscle parameters. All hard
  coded values for PCSA in the old model was converted to corresponding muscle
  volumes. Hence the dataset produces the same 


  The arm muscle parameter from AMMR 2.2  was based on a number of sources: 
  VU study 
  http://www.fbw.vu.nl/research/Lijn_A4/shoulder/overview.htm
  
   Yamaguchi
  A survey of human musculotendon actuator parameters
  G.T. Yamaguchi, A.G. Sawa, D.W. Moran, M.J. Fessler, and J.M. Winters
   multiple Muscle Systems: Biomechanics and Movement Organization
  J.M. Winters and S.L.-T. Woo (eds.) 1990 Springer- verlag, New York
  
  Juul-Kristensen2000
   muscle sizes and moment arms of the rotator cuff muscles determined by magnetic resonance imaging
  B. Juul-kristensen, F. Bojsen-Moeller, L. Finsen, J. Eriksson, G. Johansson, F. Staahlberg, C. Ekdahl
  Cell Tissues Organs 2000, 214-222
  
  Kamibayashi1998
   morphometry of human neck muscles
  Lynne K. Kamibayashi, Frances J.R. Richmond
  Spine Vol. 23,No.12, pp. 1314-1323, 1998
  
  Holzbauer2005
  Kathrine Holzbaur, Wendy Murray, Scott Delp
  A model of the upper extremity for simulating musculoskeletal surgery and analysing neuromuscular control
  Annals of biomedical engineering, Vol. 33, no. 6, june 2005 pp.829-840
  
  Bodgduk1998
  The morphology and biomechanics of latissimus dorsi
  N. Bogduk, G.Johnson, D. Spalding
  Clinical Biomechanics 13(1998) 377-385
  
  Jacobson
  Jacobson, M. D., R. Raab, B. M. Fazeli, R. A. Abrams, M. J. Botte, and R. L. Lieber.
  Architectural design of the human intrinsic hand muscles. 
   J. Hand Surg. [Am.] 17:804809, 1992.
  
  Lieber1
  Lieber, R. L., M. D. Jacobson, B. M. Fazeli, R. A. Abrams, and M. J. Botte. 
  Architecture of selected muscles of the arm and forearm: Anatomy and implications for tendon transfer.
  J. Hand Surg. [Am.] 17:787-798, 1992.
  
  Lieber2
  Lieber, R. L., B. M. Fazeli, and M. J. Botte. 
  Architecture of selected wrist flexor and extensor muscles. 
  J. Hand Surg. [Am.] 15:244-250, 1990.
  
  Murray
  Muray, W.M.,T.S. Buchanan, and S.L. Delp. 
  Scaling of peak moment arms with the elbow and forearm position
  J. Biomech. Vol. 28, pp. 513-525, 1995
*/ 

// This logic ensures that TotalTendonLength and OpatinalFiberLength are not
// created as DesignVars when they are also calibrated.
#if BM_CALIBRATION_TYPE == _CALIBRATION_TYPE_1PAR_
 #define _TENDON_LENGTH_DESIGNVAR(x) (x)
 #define _FIBER_LENGTH_DESIGNVAR(x) DesignVar(x)
#endif
#if BM_CALIBRATION_TYPE == _CALIBRATION_TYPE_2PAR_
 #define _TENDON_LENGTH_DESIGNVAR(x) (x)
 #define _FIBER_LENGTH_DESIGNVAR(x) (x)
#endif
#if BM_CALIBRATION_TYPE == _CALIBRATION_TYPE_CUSTOM_
 #define _TENDON_LENGTH_DESIGNVAR(x) DesignVar(x)
 #define _FIBER_LENGTH_DESIGNVAR(x) DesignVar(x)
#endif


AnyFolder Muscles = 
{
  AnyVar VolumeUnitFactor ??= 1e-6; ///< Unit conversion factor for volume (1e-6 > volume in cm^3)
{%- for name, param in muscles.items() %}
    {%- set Muscle = param['muscle'] -%}
    {% set Pennationangle = '{:0.3g}'.format(param['pennations angle']) -%}
    {% set MuscleVolume = '{:0.5g}'.format(param['volume']) -%}
    {% set OptimalFiberlength = '{:0.5g}'.format(param['optimal fiberlength']) -%}
    {% set TotalTendonLength = '{:0.5g}'.format(param['total tendon length']) -%}
    {% set K1 = '{:0.3g}'.format(param['K1']) -%}
    {% set K2 = '{:0.3g}'.format(param['K2']) -%}
    {% set Epsilon0 =  '{:0.5g}'.format(param['epsilon0']) -%}
    {% set Fcfast = 0.4 -%}
    {% if param['Doc comment'] -%}
    /// {{ param['Doc comment'] }}
    {%- endif %}
  {%- if param["condition"] %}
#if {{param["condition"]}}
  {%-endif %}
  AnyFolder {{ name }} = 
  {
    AnyString Muscle = "{{ Muscle }}"; ///< Descriptive name for the muscle, e.g. for plotting
    AnyIntVar MuscleElemAmount = {{param['elements']}}; ///< The total amount of elements for this muscle
    AnyFloat Pennationangle ??= DesignVar({{ Pennationangle }}); ///< Pennation angle of the muscle fibers (degres)
    AnyFloat VolumeScaleFactor ??= DesignVar(1.0); ///< Factor for scaling the muscle volume
    AnyFloat MuscleVolume ??= DesignVar({{ MuscleVolume }}); ///< Volume of the muscle  (ml)
    AnyFloat MuscleVolumeSIScaled ??= .VolumeUnitFactor*VolumeScaleFactor*MuscleVolume; ///< Scaled Volume of the muscle in SI base unit (m^3)
    AnyFloat OptimalFiberlength ??= _FIBER_LENGTH_DESIGNVAR({{ OptimalFiberlength }}); ///< Optimal working length of the muscle fiber (m)
    AnyFloat TotalTendonLength ??= _TENDON_LENGTH_DESIGNVAR({{ TotalTendonLength }});///< The total tendon length (m)
    AnyFloat K1 ??= DesignVar({{ K1 }}); ///< K1 constant in the muscle model.  Factor for determining shortening speed at optimum length
    AnyFloat K2 ??= DesignVar({{ K2 }}); ///< K2 constant in the muscle model.  Factor for determining shortening speed at optimum length
    AnyFloat Epsilon0 ??= DesignVar({{ Epsilon0 }}); ///< Epsilon bar in the muscle model. Represents tendon strain at F0
    AnyFloat Fcfast ??= DesignVar({{ Fcfast }}); ///< Factor for determining shortening speed at optimum length
  };
{%- if param["condition"] %}
#endif
{%- endif %}
{% endfor -%}

}; // Muscles

#undef _TENDON_LENGTH_DESIGNVAR
#undef _FIBER_LENGTH_DESIGNVAR